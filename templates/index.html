<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PicWizard - Image Enhancement Toolkit</title>
    <link rel="stylesheet" href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header class="py-3 mb-4 border-bottom" style="background-color: var(--dark-color); border-color: rgba(255, 255, 255, 0.1) !important;">
        <div class="container d-flex justify-content-between align-items-center">
            <h1 class="fs-4 m-0" style="color: var(--primary-color);"><i class="bi bi-magic me-2"></i>PicWizard</h1>
            <div>
                <span class="badge rounded-pill" style="background-color: var(--accent-color);">NEW</span>
                <span class="ms-2 text-light">Image Enhancement Toolkit</span>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="row mb-4">
            <div class="col-12">
                <div class="card shadow">
                    <div class="card-body upload-area" id="upload-area">
                        <div class="text-center py-5" id="upload-prompt">
                            <i class="bi bi-cloud-arrow-up fs-1" style="color: var(--primary-color);"></i>
                            <h5 class="mt-3">Drop your images here or click to browse</h5>
                            <p class="small">Supports JPG, PNG, WEBP, BMP, GIF, and TIFF formats</p>
                            <input type="file" id="file-input" accept="image/jpeg, image/png, image/webp, image/bmp, image/gif, image/tiff" multiple class="d-none">
                            <button class="btn btn-outline-primary mt-2" id="browse-btn">
                                <i class="bi bi-image me-1"></i>Choose Images
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row" id="editor-container" style="display: none;">
            <div class="col-md-8 mb-4">
                <!-- Image navigation for multiple images -->
                <div class="card shadow mb-3" id="images-navigation" style="display: none;">
                    <div class="card-body py-2">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <span class="badge rounded-pill" id="image-counter">1/1</span>
                                <span class="ms-2" id="current-filename">filename.jpg</span>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-outline-primary" id="prev-image-btn" disabled>
                                    <i class="bi bi-arrow-left"></i> Previous
                                </button>
                                <button class="btn btn-sm btn-outline-primary" id="next-image-btn" disabled>
                                    Next <i class="bi bi-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card shadow">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <span><i class="bi bi-image me-2" style="color: var(--primary-color);"></i>Image Preview</span>
                        <div class="d-flex align-items-center">
                            <select class="form-select form-select-sm me-2" id="download-format" style="width: auto;">
                                <option value="image/png" selected>PNG</option>
                                <option value="image/jpeg">JPEG</option>
                                <option value="image/webp">WebP</option>
                                <option value="image/bmp">BMP</option>
                            </select>
                            <div id="quality-control" class="d-none d-flex align-items-center">
                                <small class="me-1">Quality:</small>
                                <input type="range" class="form-range me-1" id="quality-slider" min="0.1" max="1" step="0.1" value="0.9" style="width: 60px;">
                                <span id="quality-value" class="badge bg-secondary">90%</span>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-outline-secondary" id="reset-btn">
                                    <i class="bi bi-arrow-counterclockwise"></i> Reset
                                </button>
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-outline-success dropdown-toggle" type="button" id="downloadDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        <i class="bi bi-download"></i> Download
                                    </button>
                                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="downloadDropdown">
                                        <li><button class="dropdown-item" id="download-btn">Current Image</button></li>
                                        <li><button class="dropdown-item" id="download-all-btn">All Images as ZIP</button></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-body p-0 text-center position-relative overflow-hidden">
                        <div class="comparison-slider-container">
                            <div class="comparison-slider">
                                <div class="comparison-divider"></div>
                            </div>
                            <canvas id="image-canvas" class="img-fluid"></canvas>
                        </div>
                        <div id="processing-indicator" class="position-absolute top-50 start-50 translate-middle" style="display: none;">
                            <div class="spinner-border text-light" role="status"></div>
                            <p class="text-light mt-2">Processing...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-4 mb-4">
                <div class="card shadow">
                    <div class="card-header">
                        <span><i class="bi bi-sliders me-2" style="color: var(--primary-color);"></i>Enhancement Tools</span>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <h6 class="card-subtitle mb-2">Basic Adjustments</h6>
                            <div class="list-group">
                                <div class="enhancement-tooltip">
                                    <button class="list-group-item list-group-item-action d-flex justify-content-between align-items-center" id="histogram-eq-btn">
                                        Histogram Equalization
                                        <span>
                                            <i class="bi bi-stars ai-suggestion" title="AI Suggestion"></i>
                                            <i class="bi bi-bar-chart"></i>
                                        </span>
                                    </button>
                                    <div class="tooltip-text">
                                        <strong>AI Suggestion:</strong> Perfect for improving contrast in dark or flat images. Especially effective for landscapes and black & white photos.
                                    </div>
                                </div>
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>Gamma Correction</span>
                                        <i class="bi bi-brightness-high"></i>
                                    </div>
                                    <div class="d-flex align-items-center gap-2">
                                        <input type="range" class="form-range" id="gamma-slider" min="0.1" max="3" step="0.1" value="1">
                                        <span id="gamma-value" class="badge bg-secondary">1.0</span>
                                        <button class="btn btn-sm btn-primary" id="gamma-btn">Apply</button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <h6 class="card-subtitle mb-2">Detail Enhancement</h6>
                            <div class="list-group">
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>Unsharp Mask</span>
                                        <i class="bi bi-image-alt"></i>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Amount</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="unsharp-amount-slider" min="0.1" max="3" step="0.1" value="1">
                                            <span id="unsharp-amount-value" class="badge bg-secondary">1.0</span>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Radius</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="unsharp-radius-slider" min="1" max="15" step="2" value="5">
                                            <span id="unsharp-radius-value" class="badge bg-secondary">5</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-primary w-100 mt-2" id="unsharp-mask-btn">Apply Unsharp Mask</button>
                                </div>
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>Gaussian Blur</span>
                                        <i class="bi bi-eyeglasses"></i>
                                    </div>
                                    <div class="d-flex align-items-center gap-2">
                                        <input type="range" class="form-range" id="blur-radius-slider" min="1" max="15" step="2" value="3">
                                        <span id="blur-radius-value" class="badge bg-secondary">3</span>
                                        <button class="btn btn-sm btn-primary" id="gaussian-blur-btn">Apply</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <h6 class="card-subtitle mb-2">Advanced Techniques</h6>
                            <div class="list-group">
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>Edge Detection</span>
                                        <i class="bi bi-intersect"></i>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Method</label>
                                        <div class="btn-group w-100 mb-2" role="group">
                                            <input type="radio" class="btn-check" name="edge-method" id="edge-sobel" value="sobel" checked>
                                            <label class="btn btn-sm btn-outline-secondary" for="edge-sobel">Sobel</label>
                                            <input type="radio" class="btn-check" name="edge-method" id="edge-canny" value="canny">
                                            <label class="btn btn-sm btn-outline-secondary" for="edge-canny">Canny</label>
                                        </div>
                                    </div>
                                    <div class="mb-2 canny-options" style="display: none;">
                                        <label class="form-label small">Threshold 1</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="edge-threshold1-slider" min="10" max="300" step="10" value="100">
                                            <span id="edge-threshold1-value" class="badge bg-secondary">100</span>
                                        </div>
                                        <label class="form-label small">Threshold 2</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="edge-threshold2-slider" min="10" max="300" step="10" value="200">
                                            <span id="edge-threshold2-value" class="badge bg-secondary">200</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-primary w-100 mt-2" id="edge-detection-btn">Apply Edge Detection</button>
                                </div>
                                <div class="enhancement-tooltip">
                                    <div class="list-group-item">
                                        <div class="d-flex justify-content-between align-items-center mb-2">
                                            <span>Super Resolution <i class="bi bi-stars ai-suggestion" title="AI Suggestion"></i></span>
                                            <i class="bi bi-aspect-ratio"></i>
                                        </div>
                                        <div class="tooltip-text">
                                            <strong>AI Suggestion:</strong> Best for small images that need enlargement without losing quality. Great for old photos, thumbnails, or creating prints from digital images.
                                        </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Scale Factor</label>
                                        <div class="btn-group w-100" role="group">
                                            <input type="radio" class="btn-check" name="scale-factor" id="scale-2x" value="2" checked>
                                            <label class="btn btn-sm btn-outline-secondary" for="scale-2x">2x</label>
                                            <input type="radio" class="btn-check" name="scale-factor" id="scale-3x" value="3">
                                            <label class="btn btn-sm btn-outline-secondary" for="scale-3x">3x</label>
                                            <input type="radio" class="btn-check" name="scale-factor" id="scale-4x" value="4">
                                            <label class="btn btn-sm btn-outline-secondary" for="scale-4x">4x</label>
                                        </div>
                                        <div class="small text-warning mt-2">
                                            <i class="bi bi-exclamation-triangle"></i> Higher scale factors may take longer to process
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-primary w-100 mt-2" id="super-resolution-btn">Apply Super Resolution</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <h6 class="card-subtitle mb-2">Color Adjustments</h6>
                            <div class="list-group">
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>Color Balance</span>
                                        <i class="bi bi-palette"></i>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Red Channel</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="red-slider" min="0.5" max="2" step="0.1" value="1">
                                            <span id="red-value" class="badge bg-danger">1.0</span>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Green Channel</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="green-slider" min="0.5" max="2" step="0.1" value="1">
                                            <span id="green-value" class="badge bg-success">1.0</span>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Blue Channel</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="blue-slider" min="0.5" max="2" step="0.1" value="1">
                                            <span id="blue-value" class="badge bg-primary">1.0</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-primary w-100 mt-2" id="color-balance-btn">Apply Color Balance</button>
                                </div>
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>Sepia Filter</span>
                                        <i class="bi bi-camera-fill"></i>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Intensity</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="sepia-slider" min="0.1" max="1" step="0.1" value="0.5">
                                            <span id="sepia-value" class="badge bg-secondary">0.5</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-primary w-100 mt-2" id="sepia-btn">Apply Sepia Filter</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <h6 class="card-subtitle mb-2">Special Effects</h6>
                            <div class="list-group">
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>Noise Reduction</span>
                                        <i class="bi bi-snow"></i>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Strength</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="noise-slider" min="3" max="15" step="1" value="7">
                                            <span id="noise-value" class="badge bg-secondary">7</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-primary w-100 mt-2" id="noise-reduction-btn">Apply Noise Reduction</button>
                                </div>
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>Sharpen</span>
                                        <i class="bi bi-layers-half"></i>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Strength</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="sharpen-slider" min="0.5" max="3" step="0.1" value="1">
                                            <span id="sharpen-value" class="badge bg-secondary">1.0</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-primary w-100 mt-2" id="sharpen-btn">Apply Sharpen</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <h6 class="card-subtitle mb-2">Medical Imaging</h6>
                            <div class="list-group">
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>CLAHE Enhancement</span>
                                        <i class="bi bi-file-medical"></i>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Clip Limit</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="clahe-clip-slider" min="1" max="5" step="0.5" value="2">
                                            <span id="clahe-clip-value" class="badge bg-secondary">2.0</span>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Grid Size</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="clahe-grid-slider" min="2" max="16" step="2" value="8">
                                            <span id="clahe-grid-value" class="badge bg-secondary">8</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-primary w-100 mt-2" id="clahe-btn">Apply CLAHE</button>
                                </div>
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>DICOM Windowing</span>
                                        <i class="bi bi-heart-pulse"></i>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Window Width (Contrast)</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="window-width-slider" min="50" max="600" step="50" value="400">
                                            <span id="window-width-value" class="badge bg-secondary">400</span>
                                        </div>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Window Level (Brightness)</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="window-level-slider" min="0" max="100" step="5" value="50">
                                            <span id="window-level-value" class="badge bg-secondary">50</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-primary w-100 mt-2" id="dicom-window-btn">Apply Windowing</button>
                                </div>
                                <div class="list-group-item">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span>Vessel Enhancement</span>
                                        <i class="bi bi-activity"></i>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small">Strength</label>
                                        <div class="d-flex align-items-center gap-2">
                                            <input type="range" class="form-range" id="vessel-slider" min="0.5" max="3" step="0.1" value="1.5">
                                            <span id="vessel-value" class="badge bg-secondary">1.5</span>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-primary w-100 mt-2" id="enhance-vessels-btn">Enhance Vessels</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-dark py-3 mt-auto text-center text-muted">
        <div class="container">
            <p class="m-0 small">PicWizard - A Web-Based Image Enhancement Toolkit</p>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>
